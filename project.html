<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Project</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">FM 5990</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="instructor.html">Instructor</a>
</li>
<li>
  <a href="weekly_plan.html">Weekly Plan</a>
</li>
<li>
  <a href="project.html">Project</a>
</li>
<li>
  <a href="tutorials_and_exercises.html">Tutorials &amp; Exercises</a>
</li>
<li>
  <a href="slides.html">Slides</a>
</li>
<li>
  <a href="self_study.html">Self-Study</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li>
  <a href="partners.html">Partners</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Project</h1>

</div>


<p> </p>
<div id="project-parameters" class="section level3">
<h3>Project Parameters</h3>
<p><strong>Due Date:</strong> Friday 11/30 by 12:00p.</p>
<p><strong>Format:</strong> What you turn in to me should be a self-contained R Studio project that contains all the data (which you will be provided) and a Rmarkdown file which will contain the analysis: sentences, graphs, etc. All graphs and tables should be properly labeled.</p>
<p><strong>Starter Project:</strong> I have uploaded this to the Google Drive. This Rstudio project will serve as the starting point for your analysis. I suspect that most groups will simply add an Rmarkdown file to this project, and that is what they will ultimately turn in to me. Please add any data files that you generate to the <code>data</code> subdirectory.</p>
<p>I have included my wrangling related code, as well as a variety of intermediate data files. This is in case I have to reference those files over the course of this assignment. Most groups will find no reason to touch a lot of the data, and a lot of the columns that are in the data files. It will be good practice for you to “cut through the noise” to focus in on just what is relevant to your analysis.</p>
<p> </p>
</div>
<div id="backtest-parameters" class="section level3">
<h3>Backtest Parameters</h3>
<p><strong>Strategy and Variations:</strong> All groups will backtest three variations of the same strategy: <em>selling a strangle in each underlying every month</em>. The three varitions will be the moniness (delta) of the strangles: 50%, 30%, 10%.</p>
<p><strong>Dates/Expirations:</strong> The backtest will include a total of 19 expirations: January 2017 - July 2018. The dates of the backtest will be 12/16/2016 - 7/20/2018. The expirations, along with their associated execution dates can be found in <code>project_expiration.csv</code>.</p>
<p><strong>Underlyings:</strong> There is data for 50 ETF underlyings included in the data set. You must include at least 20 underlyings in your analysis. The list of underlyings can be found in <code>project_underlying.csv</code>.</p>
<p><strong>Trades:</strong> The trades have already been calculated for <code>project_trade_master.csv</code>. (This was the first part of your initial assignment, albeit for a different time period.)</p>
<p><strong>PNLs:</strong> The PNLs for the trades have already been calculated for you and can be found in <code>project_strangle_pnl.csv</code>. (This was the second part of your initial assignment, albeit for a different time period.) There are a variety of pnl related columns in this dataset; the only ones that you need to worry about are <code>dly_opt_pnl</code>, <code>ttd_opt_pnl</code>, and <code>strangle_unity_mult</code>.</p>
<p><strong>Position Size Scaling:</strong> The prices of our underlyings vary considerably, and therefore so do the prices of their options. For the backtest, I wanted each strangle for each underlying to be approximately the same size. In particular, I created a position scaling method that would make each strangle sale to result in about $0.90 in premium. Position scaling data is stored in <code>project_position_scaling.csv</code>.</p>
<p>Here is some code to see the min, max, and average premium, sold for each variation, for all 50 underlyings.</p>
<pre class="r"><code># reading in the data
df_position_scaling &lt;- 
  read_csv(&quot;project_position_scaling.csv&quot;, col_types = cols())

# avg, min, and max premium sold for each variation
df_position_scaling %&gt;% 
  group_by(variation) %&gt;% 
  summarize(
    avg_prem = mean(strangle_prem_sold)
    , min_prem = min(strangle_prem_sold)
    , max_prem = max(strangle_prem_sold)
  )</code></pre>
<pre><code>## # A tibble: 3 x 4
##   variation avg_prem min_prem max_prem
##       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1       0.1    0.800    0.176    0.991
## 2       0.3    0.921    0.621    0.997
## 3       0.5    0.942    0.537    0.998</code></pre>
<p><strong>Calculating TTD PNL:</strong> The <code>strangle_unity_mult</code> factor is what affects the position rescaling. Here is an example query that demonstrates how to calculate the cummulative PNL for each variation, and then graph it with <code>ggplot2()</code>.</p>
<!-- fig.height = 4.5, fig.width=6.67, out.width="100%" -->
<pre class="r"><code># reading in the data  
df_pnl &lt;- 
    read_csv(&quot;project_strangle_pnl.csv&quot;, col_types = cols())

# adding a scaled PNL column, 
df_pnl &lt;- 
  df_pnl %&gt;% mutate(daily = dly_opt_pnl * strangle_unity_mult)

# adding ttd pnl column for the three strategies and plotting
df_pnl  %&gt;%  
  group_by(variation, trade_date) %&gt;% # group all pnls by variation and day
  arrange(variation, trade_date) %&gt;%  
  summarize(daily = sum(daily)) %&gt;% # adding all daily pnls for all trades  
  mutate(ttd = cumsum(daily)) %&gt;%  
  ggplot() +
    geom_line(aes(x = trade_date, y = ttd, color = factor(variation)))</code></pre>
<p><img src="project_files/figure-html/unnamed-chunk-3-1.png" width="100%" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
